$(document).ready(function(){
$.showLoading(); 
$(".loginout").click(function(){
	$.confirm({
	  title: '提示',
	  text: '退出后需重新登录,已完成的步骤将自动保存。',
	  onOK: function () {
	  	setlocalStorage('phone','');
	  	var v=Math.random();
	    window.location.href="login.html?v="+v;
	  },
	  onCancel: function () {
	  }
	});
})
$(".backzoo").click(function(){
		var v=Math.random()
		window.location.href="index.html?v="+v;
})
var phone=getlocalStorage("phone");
if(phone==null||phone=="null"||phone==undefined||phone=="undefined"||phone==""){//判断登录
	$.alert('登录失效,请重新登录!',function(){
		var v=Math.random();
		window.location.href="login.html?v="+v;
	})
		return;
}
pageInit(posturl);
function pageInit(posturl){
	var phone=getlocalStorage("phone")
	$.ajax({
		url:posturl+"/api/get",
		type:"post",
		async:false,
		data:{
			"phone":phone,
			"type":1
		},
		success:function(obj){
			console.log(obj);
			if(obj.code==200){
			  if(obj.data.status=="审核中"||obj.data.status=="审核通过"||obj.data.status=="审核不通过"){
	          	$.alert('您已经提交过资料,当前状态不可修改!',function(){
					var v=Math.random();
	          	    window.location.href="showdata.html?v="+v;
				})
	          	return;
	          }else{
	          	$("body").attr("status",obj.data.status);
	          	console.log(obj.data.status);
	          }
			  if(obj.data.divorce == null && obj.data.household == null && obj.data.hzHouse == null && obj.data.marriage == null && obj.data.otherHouse == null){
	                console.log('没有填写第一步的资料');
	                $.alert('请您先填写基本信息！',function(){
		                var v=Math.random();
		                window.location.href='index.html?v='+v;
	                })
			  }else{
				  	if(obj.data.hzHouse=='0套'&&obj.data.otherHouse=='0套'){
				  		$("body").attr("cdbh",'0套');
				  	}else{
				  		$("body").attr("cdbh",'有');
				  	}
					$("body").attr("marriage",obj.data.marriage);
					$("body").attr("divorce",obj.data.divorce);
					$("body").attr("hzHouse",obj.data.hzHouse);
					$("body").attr("otherHouse",obj.data.otherHouse);
					$("body").attr("household",obj.data.household);
					if(obj.data.household=="非杭州户籍"){
						$(".nohzpeople").show();
					}
					if(obj.data.marriage=="未婚单身"){
						console.log('未婚单身不是无房家庭')
						$("#buyer4").val('否')
						setlocalStorage("buyer4",'否');
						$('.buyer4').find(".mustspan").html('否')
				        $('.buyer4').find(".mustspan").addClass("color333");
				        $(".buyer4").removeClass("errcolor");
				        $(".cdbh").hide();
//						$(".marriage").hide();
//						$(".addzoomarriage").hide();
					}else if(obj.data.marriage=="离异单身(含带未成年子女)"){
						if(obj.data.divorce=="2018年4月4日后"){
							console.log('2018年4月4日后离异不是无房家庭')
							$("#buyer4").val('否')
							setlocalStorage("buyer4",'否');
							$('.buyer4').find(".mustspan").html('否')
					        $('.buyer4').find(".mustspan").addClass("color333");
					        $(".buyer4").removeClass("errcolor");
					        $(".cdbh").hide();
						}
//						$(".marriage").hide();
//						$(".addzoomarriageshow").show();
					}else if(obj.data.marriage=="已婚"){
//						$(".marriage").hide();
//						$(".addzoomarriageshow").show();
						$(".buyinfobtn").hide();
						$(".buyinfozoo").show()
						$(".buyinfozoo1").find(".reduceicon").hide();
					    $(".buyinfozoo1").find(".addzoochildheadspan").html("(配偶)");
					}else if(obj.data.marriage=="丧偶"){
						console.log(680)
//						$(".marriage").hide();
//						$(".addzoomarriageshow").show();
					}
					 getdata2();
			  }
			}else{
				$.alert(obj.msg,function(){
	            	if(obj.msg=='登录失效,请重新登录'){
						var v=Math.random();
					    window.location.href="login.html?v="+v;
				    }
	            });
			}
		},
		error:function(){
            $.alert("请检查您的网络，稍后再试！","提示",function(){
//          	var v=Math.random();
//				window.location.href="pre.html?v="+v;
            })
		}
	});	
}

function getdata2(){
var phone=getlocalStorage("phone")
$.ajax({//获取补充信息
    url: posturl+'/api/get',
    data: {
    	"phone":phone,
    	"type":2
    },
    type: 'POST',
    success: function (obj) {
        if(obj.code == 200){
            console.log(obj)
            if(obj.data.name==null){
            	 $.hideLoading();
            	console.log('没有填写第二步的资料');
            	showgetlocalStorage();
				return;
			}
            if(hasdata(obj.data.name)){
            	console.log('获取到的name',obj.data.name);
            	$("#buyer1").val(obj.data.name);
            }
             if(hasdata(obj.data.idCard)){
             	console.log('获取到的idCard',obj.data.idCard);
            	$("#buyer3").val(obj.data.idCard);
            }
            if(hasdata(obj.data.sale)){
            	console.log('获取到的sale',obj.data.sale);
            	$("#buyer9").val(obj.data.sale);
            	$(".buyer9 .mustspan").html(obj.data.sale);
            	$(".buyer9 .mustspan").addClass('color333');
            }
            if(hasdata(obj.data.cardType)){
            	console.log('获取到的cardType',obj.data.cardType);
            	$(".buyer2 .mustspan").html(obj.data.cardType);
            	$(".buyer2 .mustspan").addClass("color333");
            	$("#buyer2").val(obj.data.cardType)
            }
            checksfz();
            if(hasdata(obj.data.haveHouse)){
            	console.log('获取到的haveHouse',obj.data.haveHouse);
            	var marriage=$("body").attr("marriage");
            	var divorce=$("body").attr("divorce");
            	var haveHouse=obj.data.haveHouse;
            	if(marriage=='未婚单身'){
            		haveHouse='否';
            	}
            	if(marriage=='离异单身(含带未成年子女)'&&divorce=='2018年4月4日后'){
            		haveHouse='否';
            	}
            	
//          	if(marriage=='未婚单身'){
//          		haveHouse='否';
//          	}
//          	离异单身(含带未成年子女)
//          	
            	$("#buyer4").val(haveHouse);
            	$(".buyer4 .mustspan").html(haveHouse);
            	$(".buyer4 .mustspan").addClass("color333");
            	if(haveHouse=='是'){
		        	$(".cdbh").show();
		        }else{
		        	$(".cdbh").hide();
		        }
            }
            if(hasdata(obj.data.nothzHouse)){
            	console.log('获取到的nothzHouse',obj.data.nothzHouse);
            	$(".buyer5 .mustspan").html(obj.data.nothzHouse);
            	$(".buyer5 .mustspan").addClass("color333");
            	$("#buyer5").val(obj.data.nothzHouse)
            }
            
            
            if(hasdata(obj.data.loan)){
            	console.log('获取到的loan',obj.data.loan);
            	$(".buyer6 .mustspan").html(obj.data.loan);
            	$(".buyer6 .mustspan").addClass("color333");
            	$("#buyer6").val(obj.data.loan)
            }
            if(hasdata(obj.data.pay)){
            	console.log('获取到的pay',obj.data.pay);
            	$(".buyer7 .mustspan").html(obj.data.pay);
            	$(".buyer7 .mustspan").addClass("color333");
            	$("#buyer7").val(obj.data.pay)
            }
            if(hasdata(obj.data.down)){
            	console.log('获取到的down',obj.data.down);
            	$(".buyer8 .mustspan").html(obj.data.down);
            	$(".buyer8 .mustspan").addClass("color333");
            	$("#buyer8").val(obj.data.down)
            }
            if(hasdata(obj.data.parking)){
            	console.log('获取到的parking',obj.data.parking);
            	$(".buyer12 .mustspan").html(obj.data.parking);
            	$(".buyer12 .mustspan").addClass("color333");
            	$("#buyer12").val(obj.data.parking)
            }
            
            if(hasdata(obj.data.generation)){
            	console.log('获取到的generation',obj.data.generation);
            	$(".buyer10 .mustspan").html(obj.data.generation);
            	$(".buyer10 .mustspan").addClass("color333");
            	$("#buyer10").val(obj.data.generation)
            }
            
            if(hasdata(obj.data.area)){
            	console.log('获取到的area',obj.data.area);
            	$(".buyer11 .mustspan").html(obj.data.area);
            	$(".buyer11 .mustspan").addClass("color333");
            	$("#buyer11").val(obj.data.area)
            }
           
            
            var marriage=$("body").attr("marriage");
            if(hasdata(obj.data.child)&&hasdata(obj.data.hasChild)&&obj.data.child.length>0){
            	console.log('获取到的hasChild',obj.data.hasChild);
            	if(obj.data.child.length>1){
            		var str="";
            		var addzoochild1=$(".addzoomarriage").find(".addzoochild");
            		for (var i = 0; i <obj.data.child.length; i++) {
            			if(i==0){
            				$(".childname1").val(obj.data.child[0].name);
            		        $(".childcard1").val(obj.data.child[0].idCard)
            			}else{
							str=str+'<div class="addzoochild marginbottom marbottom40">';
							str=str+'<div class="addzoochildhead">未成年子女<span class="addzoochildheadspan">'+(1+addzoochild1.length)+'</span>';
							str=str+'<img class="reduceicon" src="img/reduce.png"/></div><div class="addzoochildbox">';
							str=str+'<div class="addzoochildboxleft">子女姓名</div><div class="addzoochildboxright">';
							str=str+'<input type="text"  class="childname childname'+(1+addzoochild1.length)+'" name="" id="" value="'+obj.data.child[i].name+'" placeholder="请输入子女姓名" />'
							str=str+'</div></div><div class="addzoochildbox borderbottomnone"><div class="addzoochildboxleft">身份证号</div>';			
							str=str+'<div class="addzoochildboxright"><input type="text" v="'+(1+addzoochild1.length)+'" class="childcard childcard'+(1+addzoochild1.length)+'" name="" id="" value="'+obj.data.child[i].idCard+'" placeholder="请输入证件号码" /></div></div></div>';											
							$(".jsadd").append(str)	;
            			}
            		}
            	}else{
            		$(".childname1").val(obj.data.child[0].name);
            		$(".childcard1").val(obj.data.child[0].idCard)
            	}
            }

            if(hasdata(obj.data.hasChild)){
            	console.log('获取到的child',obj.data.child);
            	$(".buyer13 .mustspan").html(obj.data.hasChild);
            	$(".buyer13 .mustspan").addClass("color333");
            	$("#buyer13").val(obj.data.hasChild)
				if(obj.data.hasChild=='是'){
					$(".marriage").hide();
				    $(".addzoomarriageshow").hide();
				    $(".addzoomarriage").show();
				}else{
					$(".marriage").hide();
					$(".addzoomarriage").hide();
					$(".addzoomarriage").hide();
				}
            }
            

            if(obj.data.other!=null&&obj.data.other!="null"&&obj.data.other.length>0){
            	$(".buyinfozoo").show();
            	$(".buyinfobtn").hide();
            	if(obj.data.other.length>1){
            		var addzoochild=$(".buyinfozoo").find(".addzoochild");
            		var str="";
            		for (var i = 0; i < obj.data.other.length; i++) {
            			if(i==0){
            				$(".buyothersname1").val(obj.data.other[0].name);
		            		$(".buyothersnum1").val(obj.data.other[0].idCard);
		            		$(".buyothersphone1").val(obj.data.other[0].phone);
		            		$(".addid1 .mustspan").html(obj.data.other[0].cardType);
		            		$("#addid1").val(obj.data.other[0].cardType);
            			}else{
							str=str+'<div class="addzoochild"><div class="addzoochildhead">其他购房人<span class="addzoochildheadspan">'+(1+addzoochild.length)+'</span><img class="reduceicon" src="img/reduce.png"/>';
							str=str+'</div><div class="addzoochildbox"><div class="addzoochildboxleft">姓名</div><div class="addzoochildboxright">';
							str=str+'<input type="text" class="buyothersname buyothersname'+(1+addzoochild.length)+'" name="" id="" value="'+obj.data.other[i].name+'" placeholder="请输入姓名" />'
						    str=str+'</div></div><div class="addzoochildbox"><div class="addzoochildboxleft">证件类型</div>';
						    str=str+'<input class="weui-input" id="addid'+(1+addzoochild.length)+'" class="" type="text" value="'+obj.data.other[i].cardType+'" readonly="">'
						    str=str+'<div class="addzoochildboxright"><label class="lineboxright alinkaddid alink addid'+(1+addzoochild.length)+'" for="addid'+(1+addzoochild.length)+'">';
						    str=str+'<span class="color333 mustspan">'+obj.data.other[i].cardType+'</span> <img class="imggo alink" src="img/go.png"/></label></div></div>';
						    str=str+'<div class="addzoochildbox"><div class="addzoochildboxleft">证件号码</div>';
						    str=str+'<div class="addzoochildboxright"><input type="text" name="" v="'+(1+addzoochild.length)+'" class="buyothersnum buyothersnum'+(1+addzoochild.length)+'" id="" value="'+obj.data.other[i].idCard+'" placeholder="请输入证件号码" /></div></div>'
						    str=str+'<div class="addzoochildbox border-bottom-none"><div class="addzoochildboxleft">手机号码</div>';
						    str=str+'<div class="addzoochildboxright"><input type="text" class="buyothersphone buyothersphone'+(1+addzoochild.length)+'" name="" id="" value="'+obj.data.other[i].phone+'" placeholder="请输入手机号码" /></div></div></div>';
							$(".jsbuyothers").append(str);
            			}
            		}
            	}else{
            		$(".buyothersname1").val(obj.data.other[0].name);
            		$(".buyothersnum1").val(obj.data.other[0].idCard);
            		$(".buyothersphone1").val(obj.data.other[0].phone);
            		$(".addid1 .mustspan").html(obj.data.other[0].cardType);
            		$("#addid1").val(obj.data.other[0].cardType);
            	}
            }
             if(obj.data.file!=null&&obj.data.file!="null"){
            	console.log('获取到的file',obj.data.file);
            	if(obj.data.file.length>1){
            		var str="";
            		for (var i = 0; i < obj.data.file.length; i++) {
            			if(i==0){
            				$(".danumberinput").val(obj.data.file[0]);
            			}else{
            				str= str+'<div class="danumber"><div class="boxfff1left">查档编号'+(i+1)+'</div><div class="boxfff1right"><div class="removedanum"><img class="removedanumicon" src="img/reduce.png"></div><input type="text" name="" class="danumberinput" value="'+obj.data.file[i]+'" placeholder="请输入编号"></div></div>	'
            			}
	            	}
            		$(".bhzoo").append(str);
            	}else{
            		$(".danumberinput").val(obj.data.file[0]);
            	}
            }
            $.hideLoading();
        }else if(obj.code == 403){
        	$.hideLoading();
            $.alert(obj.msg,function(){
            	if(obj.msg=='登录失效,请重新登录'){
					var v=Math.random();
				    window.location.href="login.html?v="+v;
			    }
            });
        }else{
        	$.hideLoading();
            $.alert(obj.msg)
        }
    },
    error:function(msg){
    	$.hideLoading();
    	console.log(msg)
    }
});  
}
function showgetlocalStorage(){
	console.log('读取缓存')
	var buyer1=getlocalStorage("buyer1");
	if(hasdata(buyer1)){
		$("#buyer1").val(buyer1);
	}
	var buyer2=getlocalStorage("buyer2");
	if(hasdata(buyer2)){
		$("#buyer2").val(buyer2);
		$(".buyer2 .mustspan").html(buyer2);
		$(".buyer2 .mustspan").addClass("color333");
	}
	var buyer3=getlocalStorage("buyer3");
	if(hasdata(buyer3)){
		$("#buyer3").val(buyer3);
	}
	var buyer4=getlocalStorage("buyer4");
	if(hasdata(buyer4)){
		$("#buyer4").val(buyer4);
		$(".buyer4 .mustspan").html(buyer4);
		$(".buyer4 .mustspan").addClass("color333");
		if(buyer4=='是'){
        	$(".cdbh").show();
        	console.log('无房家庭需要查档.')
        }else{
        	$(".cdbh").hide();
        }
	}
	var buyer9=getlocalStorage("buyer9");
	if(hasdata(buyer9)){
		$("#buyer9").val(buyer9);
		$(".buyer9 .mustspan").html(buyer9);
		$(".buyer9 .mustspan").addClass("color333");
	}
	var buyer10=getlocalStorage("buyer10");
	if(hasdata(buyer10)){
		$("#buyer10").val(buyer10);
		$(".buyer10 .mustspan").html(buyer10);
		$(".buyer10 .mustspan").addClass("color333");
	}
	var buyer11=getlocalStorage("buyer11");
	if(hasdata(buyer11)){
		$("#buyer11").val(buyer11);
		$(".buyer11 .mustspan").html(buyer11);
		$(".buyer11 .mustspan").addClass("color333");
	}
    var buyer12=getlocalStorage("buyer12");
	if(hasdata(buyer12)){
		$("#buyer12").val(buyer12);
		$(".buyer12 .mustspan").html(buyer12);
		$(".buyer12 .mustspan").addClass("color333");
	}
	var buyer13=getlocalStorage("buyer13");
	if(hasdata(buyer13)){
		$("#buyer13").val(buyer13);
		$(".buyer13 .mustspan").html(buyer13);
		$(".buyer13 .mustspan").addClass("color333");
		console.log('读缓存是否有子女',buyer13)
		if(buyer13=='是'){
			$(".marriage").hide();
		    $(".addzoomarriageshow").hide();
		    $(".addzoomarriage").show();
		}else{
			$(".marriage").hide();
			$(".addzoomarriage").hide();
			$(".addzoomarriage").hide();
		}
		
		
	}
}


$(".imgback").click(function(){
	$(".zzc").hide();
});
$(".zzcclose").click(function(){
	$(".zzc").hide();
});
$(".howtoget").click(function(){
	$(".zzc").show();
	$(".example2").show();
	$(".example1").hide();
})
$(".bigimgbtn").click(function(){
	$(".zzc").show();
	$(".example1").show();
	$(".example2").hide();
})
	
$(".addzooaddmoreda").click(function(){
	var bhbigzoo=$(".bhbigzoo").find(".danumber");
	
	var str='<div class="danumber"><div class="boxfff1left">查档编号'+(bhbigzoo.length+1)+'</div><div class="boxfff1right"><div class="removedanum"><img class="removedanumicon" src="img/reduce.png"/></div>';
	str=str+'<input type="text" name="" class="danumberinput" value="" placeholder="请输入编号" /></div></div>';
	$(".bhzoo").append(str);
})
function ifbhzoo(){
	    var bhbigzoo=$(".bhbigzoo").find(".danumber");
		console.log(bhbigzoo.length);
		var arr=[];
		for(var i = 0; i < bhbigzoo.length; i++) {
			var thisfor=$(".bhbigzoo").find(".danumber").eq(i).find(".danumberinput").val();
			if(thisfor==""){
				return false;
			}else{
				arr[arr.length]=thisfor;
			}
		}
		return arr;
}	
$(".bhzoo").on("click",".removedanumicon",function(){
	$(this).parents(".danumber").remove();
	var bhbigzoo=$(".bhbigzoo").find(".danumber");
	console.log(bhbigzoo.length);
	for(var i = 0; i < bhbigzoo.length; i++) {
		$(".bhzoo").find(".danumber").eq(i).find(".boxfff1left").html("查档编号"+(i+2))
	}
})
$("body").on("input propertychange","#buyer1",function(){
	var buyer1=$("#buyer1").val();
	if(!checkname(buyer1)){
	   $("#buyer1").parent(".linebox").addClass("errcolor");
	}else{
		setlocalStorage("buyer1",buyer1);
	   	$("#buyer1").parent(".linebox").removeClass("errcolor")
	}
}) 
$("body").on("input propertychange","#buyer3",function(){
   checksfz();
}) 
function checksfz(){
	var buyer3=$("#buyer3").val();
   if(buyer3==""){
// 		$(".buyer3").addClass("errcolor");
   }else{
   	    var buyer2=$("#buyer2").val();
   	    console.log(checkID(buyer3))
   	    if(buyer2=='身份证'){
   	    	if(checkID(buyer3)==true){
	   	    	setlocalStorage("buyer3",buyer3);
	   	    	for (var i = 0; i < $(".buyothersnum").length; i++) {
	   	    	   if($(".buyothersnum").eq(i).val().replace(/\s/g,"")==buyer3){
	   	    	   	console.log($(".buyothersnum").eq(i).val())
	   	    	   	$.toast("主购房人身份信息不能与其他购房人相同", "cancel");
	   	    	   	return;
	   	    	   }
	   	    	}
	   	    	
	   	    	for (var i = 0; i < $(".childcard").length; i++) {
	   	    	   if($(".childcard").eq(i).val().replace(/\s/g,"")==buyer3){
	   	    	   	console.log($(".buyothersnum").eq(i).val())
	   	    	   	$.toast("主购房人身份信息不能与子女信息相同", "cancel");
	   	    	   	return;
	   	    	   }
	   	    	}
	   	    	
	     	    $(".buyer3").removeClass("errcolor")
	     	    $("#buyer3").removeClass("errcolor")
	   	    }else{
	   	    	$(".buyer3").addClass("errcolor");
	   	    	$("#buyer3").addClass("errcolor");
	   	    }
   	    }else{
   	    	for (var i = 0; i < $(".buyothersnum").length; i++) {
	   	    	   if($(".buyothersnum").eq(i).val()==buyer3){
	   	    	   	$.toast("主购房人身份信息不能与其他购房人相同", "cancel");
	   	    	   	return;
	   	    	   }
	   	    }
   	    	
   	    	$(".buyer3").removeClass("errcolor")
	     	$("#buyer3").removeClass("errcolor")
   	    }
   }
}
//$("body").on("input propertychange","#buyer9",function(){
// var buyer9=$("#buyer9").val();
// if(buyer9=="请选择"){
// 	   	$(".buyer9").addClass("errcolor");
// 	   	return;
// }else{
// 	    setlocalStorage("buyer9",buyer9);
// 		$(".buyer9").removeClass("errcolor")
// }
//}) 
$(".btn.top122").click(function(){//点击提交
		var buyer1=$("#buyer1").val().replace(/\s/g,"");
	   if(!checkname(buyer1)){
		   $.alert("请填写主购房人姓名");
		   $("#buyer1").parent(".linebox").addClass("errcolor");
		   return;
	   }else{
	   		$("#buyer1").parent(".linebox").removeClass("errcolor")
	   }
	   var buyer2=$("#buyer2").val();
	   if(buyer2=="请选择"){
	   	   	$(".buyer2").addClass("errcolor");
	   		$.alert("请选择主购房人证件类型");return;
	   }else{
	   		$(".buyer2").removeClass("errcolor")
	   }
		
	
   var buyer3=$("#buyer3").val().replace(/\s/g,"");;
   if(buyer3==""){
   		$(".buyer3").addClass("errcolor");
	   	$.alert("请输入主购房人证件号码");return;
   }else{
   	    var buyer2=$("#buyer2").val();
   	     console.log(checkID(buyer3))
   	     for (var i = 0; i < $(".buyothersnum").length; i++) {
    	   if($(".buyothersnum").eq(i).val().replace(/\s/g,"")==buyer3){
    	   	$.alert("主购房人身份信息不能与其他购房人"+(i+1)+"相同");
    	   	return;
    	   }
	   	 }
   	    if(buyer2=='身份证'){
   	    	if(checkID(buyer3)==true){
	     	     $(".buyer3").removeClass("errcolor")
	     	     $("#buyer3").removeClass("errcolor")
	   	    }else{
	   	    	$(".buyer3").addClass("errcolor");
	   	    	$("#buyer3").addClass("errcolor");
	   	    	$.alert("请输入有效主购房人证件号码");return;
	   	    }
   	    }
   }
	   var buyer4=$("#buyer4").val();
	   if(buyer4==""){
	   	   	$(".buyer4").addClass("errcolor");
	   		$.alert("请选择主购房人无房家庭");return;
	   }else{
	   		$(".buyer4").removeClass("errcolor")
	   		if(buyer4=='是'){
	   			$(".cdbh").show();
	   		}else{
	   			$(".cdbh").hide();
	   		}
	   }
	   
	   var household=$("body").attr("household");
	   if(household=="非杭州户籍"){
	   	 var buyer5=$("#buyer5").val();
	   	 if(buyer5=="请选择"){
	   	 	$.alert("请选择主购房人非杭州市（含四县市）住房");
	   	 	$(".nohzpeople").addClass("errcolor");
	   	 	return;
	   	 }else{
	   	 	$(".nohzpeople").removeClass("errcolor")
	   	 }
	   }
	   
	
	   
	   var buyer6=$("#buyer6").val();
	   if(buyer6==""){
	   	   	$(".buyer6").addClass("errcolor");
	   		$.alert("请选择主购房人全国住房贷款记录");return;
	   }else{
	   		$(".buyer6").removeClass("errcolor")
	   }
	   var buyer7=$("#buyer7").val();
	   if(buyer7==""){
	   	   	$(".buyer7").addClass("errcolor");
	   		$.alert("请选择主购房人付款方式");return;
	   }else{
	   		$(".buyer7").removeClass("errcolor")
	   }
	   
	   var buyer8=$("#buyer8").val();
	   if(buyer8==""){
	   	   	$(".buyer8").addClass("errcolor");
	   		$.alert("请选择主购房人首付比例");return;
	   }else{
	   		$(".buyer8").removeClass("errcolor")
	   }
	   var buyer9=$("#buyer9").val();
	   console.log(buyer9)
	   if(buyer9==""){
	   	 $(".buyer9").addClass("errcolor");
	   	 $.alert("请输入销售顾问姓名");return;
	   }else{ 
           $(".buyer9").removeClass("errcolor")
	  }
	var arr=[];
	var ifbhzoo=arr;
	var buyer10=$("#buyer10").val();//年龄段
	var buyer11=$("#buyer11").val();//需求面积
	var buyer12=$("#buyer12").val();//是否购买车位
	var buyer13=$("#buyer13").val();//是否购买车位
	var buyer10=$("#buyer10").val();//年龄段
   if(buyer10==""){
   	   	$(".buyer10").addClass("errcolor");
   		$.alert("请选择主购房人年龄段");return;
   }else{
   		$(".buyer10").removeClass("errcolor")
   }
	var buyer11=$("#buyer11").val();//年龄段
	if(buyer11==""){
	   	   	$(".buyer11").addClass("errcolor");
	   		$.alert("请选择需求面积");return;
	}else{
	   		$(".buyer11").removeClass("errcolor")
	}
	var buyer12=$("#buyer12").val();//年龄段
	if(buyer12==""){
	   	   	$(".buyer12").addClass("errcolor");
	   		$.alert("请选择是否购买车位");return;
	}else{
	   		$(".buyer12").removeClass("errcolor")
	}
	var buyer13=$("#buyer13").val();//子女
	if(buyer13==""){
	   	   	$(".buyer13").addClass("errcolor");
	   		$.alert("请选择是否带子女");return;
	}else{
	   		$(".buyer13").removeClass("errcolor")
	}
	var child=new Array();  
//	if($(".addzoomarriageshow").is(':hidden')){
//	   var marriage=$("body").attr("marriage");
	if(buyer13=="是"){//检查zinv
		var addchild=$(".addzoomarriage").find(".addzoochild").length;
		for(var i = 0; i < $(".addzoomarriage").find(".addzoochild").length; i++){
			var childname=$(".addzoomarriage").find(".addzoochild").eq(i).find(".childname").val();
			if(!checkname(childname)){
				$(".addzoomarriage").find(".addzoochild").eq(i).find(".childname").eq(0).parents(".addzoochildbox").css({"color":"red"});
				$.alert("未成年子女"+(i+1)+"姓名无效！");
				return;
			}
			var childcard=$(".addzoomarriage").find(".addzoochild").eq(i).find(".childcard").val();
			if(checkID(childcard)!=true){
				$(".addzoomarriage").find(".addzoochild").eq(i).find(".childcard").parents(".addzoochildbox").css({"color":"red"});
				$.alert("未成年子女"+(i+1)+"身份证号无效！");
				return;
			}
			for (var c = 0; c < child.length; c++) {
				if(child[c].childcard==childcard){
					$.alert("未成年子女"+(i+1)+"与未成年子女"+(c+1)+"身份证号不能相同！");
				    return;
				}
			}
			var childobj={
				"name":childname,
				"idCard":childcard
			}
			child[child.length]=childobj;
		}
	}
//	}
	var other=new Array();
	if(!$(".buyinfobtn").is(':hidden')){　　//如果node是隐藏的则显示node元素，否则隐藏
	}else{
		var addzoochild=$(".buyinfozoo").find(".addzoochild");
		for (var i = 0; i < addzoochild.length; i++) {
			var buyothersname=$(".buyinfozoo").find(".addzoochild").eq(i).find(".buyothersname").val().replace(/\s/g,"");
			if(!checkname(buyothersname)){
				$(".buyinfozoo").find(".addzoochild").eq(i).find(".buyothersname").parents(".addzoochildbox").css({"color":"red"});
				$.alert("其他购房人"+(i+1)+"姓名不能为空");
				return;
			}
			var cardType1=$(".buyinfozoo").find(".addzoochild").eq(i).find(".alinkaddid").attr("for");
			console.log(cardType1)
			var cardType=$("#"+cardType1).val();
			var buyothersnum=$(".buyinfozoo").find(".addzoochild").eq(i).find(".buyothersnum").val();
			buyothersnum=buyothersnum.replace(/\s/g,"");
			if(buyothersnum==""){
				$(".buyinfozoo").find(".addzoochild").eq(i).find(".buyothersnum").parents(".addzoochildbox").css({"color":"red"});
				$.alert("其他购房人"+(i+1)+"证件号码不能为空");
				return;
			}
			if(cardType=='身份证'){
				if(checkID(buyothersnum)==true){
					
				}else{
					$.alert("其他购房人"+(i+1)+"身份证号无效");
					return;
				}
			}
			var buyer3=$("#buyer3").val();
			if(buyothersnum==buyer3){
				$.alert("其他购房人"+(i+1)+"证件号码不能与主购房人相同");
				return;
			}
			for (var o= 0; o < other.length; o++) {
				if(other[o].buyothersnum==buyothersnum){
					$.alert("其他购房人"+(i+1)+"证件号码不能与其他购房人"+(o+1)+"相同");
				    return;
				}
			}
			var buyothersphone=$(".buyinfozoo").find(".addzoochild").eq(i).find(".buyothersphone").val();
			buyothersphone=buyothersphone.replace(/\s/g,"");
			if(!checkPhone(buyothersphone)){
				$(".buyinfozoo").find(".addzoochild").eq(i).find(".buyothersphone").parents(".addzoochildbox").css({"color":"red"});
				$.alert("其他购房人"+(i+1)+"手机号码无效");
				return;
			}
			var otherobj={
				"name":buyothersname,
				"idCard":buyothersnum,
				"phone":buyothersphone,
				"cardType":cardType
			}
			other[other.length]=otherobj;
		}
	   
	}


 var buyer4=$("#buyer4").val();
 if(buyer4=='是'){
 	var bhbigzoo=$(".bhbigzoo").find(".danumber");
	console.log(bhbigzoo.length);
	for(var i = 0; i < bhbigzoo.length; i++) {
		var thisfor=$(".bhbigzoo").find(".danumber").eq(i).find(".danumberinput").val();
		if(thisfor==""){
			$.alert("查档编号不能为空!");
			return;
		}else{
			arr[arr.length]=thisfor;
		}
	}
 }else{
 	ifbhzoo='';
 }

	
	var status=$("body").attr("status");
	if(status=="审核中"){
		$.alert("您的资料正在审核中,不可修改!","提示",function(){
			window.location.replace("showdata.html");
		})
		return;
	}
	if(status=="审核通过"){
		$.alert("您提交过资料，审核通过，不能修改！","提示");
		window.location.replace("showdata.html");
		return;
	}
	console.log(child)
	var phone=getlocalStorage("phone")
	var posturl=ajaxurl;
	$.ajax({
		type:"post",
		url:posturl+"/api/add",
	//	Content-Type: 'application/json;charset=utf-8',
	//	traditional: true,
		data:{
			"phone":phone,
			"name":buyer1,//姓名
			"cardType":buyer2,//证件类型	
			"idCard":buyer3,//证件号码	
			"haveHouse":buyer4,//无房家庭	
			"loan":buyer6,//全国住房贷款记录	
			"pay":buyer7,//付款方式	
			"generation":buyer10,
			"area":buyer11,
			"parking":buyer12,
			"hasChild":buyer13,
			"file":ifbhzoo,//档案编号	
			"child":child,
			"other":other,
			"sale":buyer9,
			"down":buyer8,
			"nothzHouse":buyer5
		},
		success:function(obj){
			if(obj.code==200){
				var v=Math.random();
				$.toast("保存成功", 200,function(){
						window.location.href="index3.html?v="+v;
				});
			}else{
				$.alert(obj.msg,function(){
					var v=Math.random();
					if(obj.msg=='登录失效,请重新登录'){
						window.location.href="login.html?v="+v;
					}
				})
			}
			console.log(obj)
		},
		error:function(msg){
			
		}
	});
	

})


$(".page2").on("input propertychange" ,".buyothersnum",function(){
	var buyer3=$("#buyer3").val();//主购房人证件号
	var thisv=$(this).val();//其他购房人证件号
	var v=$(this).attr("v");//下标
	var addid=$("#addid"+v).val();
	if(addid=='身份证'){
		if(checkID(thisv)==true){
     	    $(this).removeClass("errcolor")
   	    }else{
   	    	$(this).addClass("errcolor");
   	    	return
   	    }
	}else{
		 $(this).removeClass("errcolor")
	}
	if(buyer3==thisv){
		$(this).addClass("errcolor");
		$(this).addClass("colorredno");
		$.toast("其他购房人身份信息不能与主购房人相同", "cancel");
	}else{
		var c=1;
		for (var i = 0; i < $(".buyothersnum").length; i++) {
			if(v!=(i+1)){
				if($(".buyothersnum").eq(i).val()==thisv){
					c=2;
					$(this).addClass("errcolor");
					$(this).addClass("colorredno");
					$.toast("其他购房人身份信息不能重复", "cancel");
				}
			}
		}
		if(c==1){
			$(this).removeClass("errcolor")
		    $(this).removeClass("colorredno");
		    $.hideLoading();
		}
	}
})

$(".page2").on("input propertychange" ,".childcard",function(){
	var buyer3=$("#buyer3").val();
	var thisv=$(this).val();
	var v=$(this).attr("v");
		if(checkID(thisv)==true){
     	    $(this).removeClass("errcolor")
   	    }else{
   	    	$(this).addClass("errcolor");
   	    	return
   	    }
	if(buyer3==thisv){
		$(this).addClass("errcolor");
		$(this).addClass("colorredno");
		$.toast("子女身份信息不能与主购房人相同", "cancel");
	}else{
		var d=1;
		for (var i = 0; i < $(".childcard").length; i++) {
			if(v!=(i+1)){
				if($(".childcard").eq(i).val()==thisv){
					d=2;
					$(this).addClass("errcolor");
					$(this).addClass("colorredno");
					$.toast("子女信息不能重复", "cancel");
				}
			}
		}
		if(d==1){
			$(this).removeClass("errcolor")
		    $(this).removeClass("colorredno");
		     $.hideLoading();
		}
	}
})
  


$(".buyinfobtn").click(function(){
	var marriage=$("body").attr("marriage");
	if(marriage=="未婚单身"){
		$(".buyinfozoo1").find(".reduceicon").show();
		$(".buyinfozoo1").find(".addzoochildheadspan").html("1");
	}else if(marriage=="离异单身(含带未成年子女)"){
		$(".buyinfozoo1").find(".reduceicon").show();
		$(".buyinfozoo1").find(".addzoochildheadspan").html("1");
	}else if(marriage=="已婚"){
		$(".buyinfozoo1").find(".reduceicon").hide();
		$(".buyinfozoo1").find(".addzoochildheadspan").html("(配偶)");
	}else if(marriage=="丧偶"){
		$(".buyinfozoo1").find(".reduceicon").show();
		$(".buyinfozoo1").find(".addzoochildheadspan").html("1");
	}
	$(".buyinfozoo").show();
	$(".buyinfobtn").hide();
})












$(".buyothermore").click(function(){
	var addzoochild=$(".buyinfozoo").find(".addzoochild");
	console.log(addzoochild.length)
	var str='<div class="addzoochild"><div class="addzoochildhead">其他购房人<span class="addzoochildheadspan">'+(1+addzoochild.length)+'</span><img class="reduceicon" src="img/reduce.png"/>';
	str=str+'</div><div class="addzoochildbox"><div class="addzoochildboxleft">姓名</div><div class="addzoochildboxright">';
	str=str+'<input type="text" class="buyothersname buyothersname'+(1+addzoochild.length)+'" name="" id="" value="" placeholder="请输入姓名" />'
    str=str+'</div></div><div class="addzoochildbox"><div class="addzoochildboxleft">证件类型</div>';
    str=str+'<input class="weui-input" id="addid'+(1+addzoochild.length)+'" class="" type="text" value="身份证" readonly="">'
    str=str+'<div class="addzoochildboxright"><label class="lineboxright alinkaddid alink addid'+(1+addzoochild.length)+'" for="addid'+(1+addzoochild.length)+'">';
    str=str+'<span class="color333 mustspan">身份证</span> <img class="imggo alink" src="img/go.png"/></label></div></div>';
    str=str+'<div class="addzoochildbox"><div class="addzoochildboxleft">证件号码</div>';
    str=str+'<div class="addzoochildboxright"><input type="text" name="" v="'+(1+addzoochild.length)+'" class="buyothersnum buyothersnum'+(1+addzoochild.length)+'" id="" value="" placeholder="请输入证件号码" /></div></div>'
    str=str+'<div class="addzoochildbox border-bottom-none"><div class="addzoochildboxleft">手机号码</div>';
    str=str+'<div class="addzoochildboxright"><input type="text" v="'+(1+addzoochild.length)+'" class="buyothersphone buyothersphone'+(1+addzoochild.length)+'" name="" id="" value="" placeholder="请输入手机号码" /></div></div></div>';
	$(".jsbuyothers").append(str);
	
$(".page2 #addid"+(1+addzoochild.length)).picker({
    title: "请选择",
    cols: [
      {
        textAlign: 'center',
         values: ['身份证', '军官证','护照']
      }
    ],
    onChange: function(p, v, dv) {
      $("#addid"+(1+addzoochild.length)).val(dv[0]);
      console.log(dv[0]);
    },
    onClose: function(p, v, d) {
    	var buyer2=$("#addid"+(1+addzoochild.length)).val();
    	$(".addid"+(1+addzoochild.length)).find(".mustspan").html(buyer2);
        $('.addid'+(1+addzoochild.length)).find(".mustspan").addClass("color333");
        var cardnum=$(".buyothersnum"+(1+addzoochild.length)).val();
        if(buyer2=='身份证'){
			if(checkID(cardnum)==true){
	     	    $(".buyothersnum"+(1+addzoochild.length)).removeClass("errcolor")
	   	    }else{
	   	    	$(".buyothersnum"+(1+addzoochild.length)).addClass("errcolor");
	   	    	return
	   	    }
		}else{
			 $(".buyothersnum"+(1+addzoochild.length)).removeClass("errcolor")
		}
        
        
    }
});
	
})


$(".page2 #addid1").picker({
    title: "请选择",
    cols: [
      {
        textAlign: 'center',
         values: ['身份证', '军官证','护照']
      }
    ],
    onChange: function(p, v, dv) {
      $("#addid1").val(dv[0]);
      console.log(dv[0]);
    },
    onClose: function(p, v, d) {
    	var buyer2=$("#addid1").val();
    	$(".addid1").find(".mustspan").html(buyer2);
        $('.addid1').find(".mustspan").addClass("color333");
        var cardnum=$(".buyothersnum1").val();
        if(buyer2=='身份证'){
			if(checkID(cardnum)==true){
	     	    $(".buyothersnum1").removeClass("errcolor")
	   	    }else{
	   	    	$(".buyothersnum1").addClass("errcolor");
	   	    	return
	   	    }
		}else{
			 $(".buyothersnum1").removeClass("errcolor")
		}
        
    }
});



								
							
									
								
								
										
							
							
								
							
							
								





















$(".buyinfozoo").on("click",".reduceicon",function(){//其他购房者信息减少
	var addzoochild=$(".buyinfozoo").find(".addzoochild");
	if(addzoochild.length==1){
		$(".buyinfozoo").hide();
		$(".buyinfobtn").show();
		for (var i = 0; i <$(".buyinfozoo").find(".addzoochild").length; i++) {
			$(".buyinfozoo").find(".addzoochild").eq(i).find(".buyothersname").val('');
			$(".buyinfozoo").find(".addzoochild").eq(i).find(".buyothersnum").val('')
			$(".buyinfozoo").find(".addzoochild").eq(i).find(".buyothersphone").val('')
		}
	}else{
		$(this).parents(".addzoochild").remove();
		console.log(142)
		for (var i = 0; i <$(".buyinfozoo").find(".addzoochild").length; i++) {
			console.log($(".buyinfozoo").find(".addzoochild").eq(i).find(".addzoochildheadspan"))
			var addzoochildheadspan=$(".buyinfozoo").find(".addzoochild").eq(i).find(".addzoochildheadspan").text();
			$(".buyinfozoo").find(".addzoochild").eq(i).find(".buyothersname").removeClass("buyothersname"+addzoochildheadspan*1);
			$(".buyinfozoo").find(".addzoochild").eq(i).find(".buyothersname").addClass("buyothersname"+(1+i));
			$(".buyinfozoo").find(".addzoochild").eq(i).find(".buyothersnum").removeClass("buyothersnum"+addzoochildheadspan*1);
			$(".buyinfozoo").find(".addzoochild").eq(i).find(".buyothersnum").addClass("buyothersnum"+(1+i));
			$(".buyinfozoo").find(".addzoochild").eq(i).find(".buyothersphone").removeClass("buyothersphone"+addzoochildheadspan*1);
			$(".buyinfozoo").find(".addzoochild").eq(i).find(".buyothersphone").addClass("buyothersphone"+(1+i));
			$(".buyinfozoo").find(".addzoochild").eq(i).find(".addzoochildheadspan").html(i+1)
		}
	}
})







$(".buyinfozoo").on("input propertychange",".buyothersphone",function(){
	var thisv=$(this).val();
	if(checkPhone(thisv)!=true){
		$(this).parents(".addzoochildbox").css({"color":"red"})
	}else{
		console.log(thisv+'-');
		$(this).parents(".addzoochildbox").removeAttr("style");
	}
	console.log(thisv);
}) 
$(".buyinfozoo").on("input propertychange",".buyothersname",function(){
	var thisv=$(this).val();
	if(checkname(thisv)!=true){
		$(this).parents(".addzoochildbox").css({"color":"red"})
	}else{
		console.log(thisv+'-');
		$(this).parents(".addzoochildbox").removeAttr("style");
	}
	console.log(thisv);
})
function checkPhone(phone){ 
    if(!(/^1[3|4|5|6|7|8|9]\d{9}$/.test(phone))){ 
//      alert("手机号码有误，请重填");  
        return false; 
    }else{
    	return true;
    }
}





$(".addzoomarriage").on("click",".reduceicon",function(){//子女信息减少
	var addzoochild=$(".addzoomarriage").find(".addzoochild");
	if(addzoochild.length==1){
		$(".addzoomarriage").hide();
		$(".addzoomarriageshow").show();
	}else{
		$(this).parents(".addzoochild").remove();
		console.log(142)
		for (var i = 0; i <$(".addzoomarriage").find(".addzoochild").length; i++) {
			console.log(i)
			console.log($(".addzoomarriage").find(".addzoochild").eq(i).find(".addzoochildheadspan"))
			var addzoochildheadspan=$(".addzoomarriage").find(".addzoochild").eq(i).find(".addzoochildheadspan").text();
			$(".addzoomarriage").find(".addzoochild").eq(i).find(".childname").removeClass("childname"+addzoochildheadspan*1);
			$(".addzoomarriage").find(".addzoochild").eq(i).find(".childname").addClass("childname"+(1+i));
			$(".addzoomarriage").find(".addzoochild").eq(i).find(".childcard").removeClass("childcard"+addzoochildheadspan*1);
			$(".addzoomarriage").find(".addzoochild").eq(i).find(".childcard").addClass("childcard"+(1+i));
			$(".addzoomarriage").find(".addzoochild").eq(i).find(".addzoochildheadspan").html(i+1)
		}
	}
})
$(".addzoomarriageshow").click(function(){//添加子女信息
	$(".addzoomarriageshow").hide();
	$(".addzoomarriage").show();
})
$(".marriagemore").click(function(){
	var addzoochild1=$(".addzoomarriage").find(".addzoochild");
	var str='<div class="addzoochild marginbottom marbottom40">';
	str=str+'<div class="addzoochildhead">未成年子女<span class="addzoochildheadspan">'+(1+addzoochild1.length)+'</span>';
	str=str+'<img class="reduceicon" src="img/reduce.png"/></div><div class="addzoochildbox">';
	str=str+'<div class="addzoochildboxleft">子女姓名</div><div class="addzoochildboxright">';
	str=str+'<input type="text"  class="childname childname'+(1+addzoochild1.length)+'" name="" id="" value="" placeholder="请输入子女姓名" />'
	str=str+'</div></div><div class="addzoochildbox borderbottomnone"><div class="addzoochildboxleft">身份证号</div>';			
	str=str+'<div class="addzoochildboxright"><input type="text" v="'+(1+addzoochild1.length)+'" class="childcard childcard'+(1+addzoochild1.length)+'" name="" id="" value="" placeholder="请输入证件号码" /></div></div></div>';											
	$(".jsadd").append(str)	;				
})

$(".addzoomarriage").on("input propertychange",".childcard",function(){
	var thisv=$(this).val();
	if(checkID(thisv)!=true){
		$(this).parents(".addzoochildbox").css({"color":"red"})
	}else{
		console.log(thisv+'-');
		$(this).parents(".addzoochildbox").removeAttr("style");
	}
	console.log(thisv);
})
$(".addzoomarriage").on("input propertychange",".childname",function(){
	var thisv=$(this).val();
	if(checkname(thisv)!=true){
		$(this).parents(".addzoochildbox").css({"color":"red"})
	}else{
		console.log(thisv+'-');
		$(this).parents(".addzoochildbox").removeAttr("style");
	}
	console.log(thisv);
})

function checkname(name){
	console.log(name)
	if(name==""||name=="undefined"||name==undefined||name==null||name=="null"){
		return false;
	}else{
		if(name.length<=1){
			return false;
		}else{
			if(!isNaN(name)){
				return false;
			}else{
				return true;
			}
		}
	}
}
function checkID(ID) {
    if(typeof ID !== 'string') return '非法字符串';
    var city = {11:"北京",12:"天津",13:"河北",14:"山西",15:"内蒙古",21:"辽宁",22:"吉林",23:"黑龙江 ",31:"上海",32:"江苏",33:"浙江",34:"安徽",35:"福建",36:"江西",37:"山东",41:"河南",42:"湖北 ",43:"湖南",44:"广东",45:"广西",46:"海南",50:"重庆",51:"四川",52:"贵州",53:"云南",54:"西藏 ",61:"陕西",62:"甘肃",63:"青海",64:"宁夏",65:"新疆",71:"台湾",81:"香港",82:"澳门",91:"国外"};
    var birthday = ID.substr(6, 4) + '/' + Number(ID.substr(10, 2)) + '/' + Number(ID.substr(12, 2));
    var d = new Date(birthday);
    var newBirthday = d.getFullYear() + '/' + Number(d.getMonth() + 1) + '/' + Number(d.getDate());
    var currentTime = new Date().getTime();
    var time = d.getTime();
    var arrInt = [7, 9, 10, 5, 8, 4, 2, 1, 6, 3, 7, 9, 10, 5, 8, 4, 2];
    var arrCh = ['1', '0', 'X', '9', '8', '7', '6', '5', '4', '3', '2'];
    var sum = 0, i, residue;
    if(!/^\d{17}(\d|x)$/i.test(ID)) return '非法身份证';
    if(city[ID.substr(0,2)] === undefined) return "非法地区";
    if(time >= currentTime || birthday !== newBirthday) return '非法生日';
    for(i=0; i<17; i++) {
      sum += ID.substr(i, 1) * arrInt[i];
    }
    residue = arrCh[sum % 11];
    if (residue !== ID.substr(17, 1)) return '非法身份证哦';
    return true;
//  city[ID.substr(0,2)]+","+birthday+","+(ID.substr(16,1)%2?" 男":"女")
}
$(".page2 #buyer5").picker({
			    title: "请选择",
			    cols: [
			      {
			        textAlign: 'center',
			         values: ['0套', '1套','2套及以上']
			      }
			    ],
			    onChange: function(p, v, dv) {
			      $("#buyer5").val(dv[0]);
			      console.log(dv[0]);
			    },
			    onClose: function(p, v, d) {
			    	var buyer2=$("#buyer5").val();
			    	$(".buyer5").find(".mustspan").html(buyer2);
//			    	if(buyer2=="2套及以上"){
//			    		buyer8arr=['全款'];
//			    	}else if(buyer2=="2套及以上"){
//			    		
//			    	}
			    	$(".nohzpeople").removeClass("errcolor")
			        $('.buyer5').find(".mustspan").addClass("color333");
			    }
});


$(".page2 #buyer2").picker({
    title: "请选择",
    cols: [
      {
        textAlign: 'center',
         values: ['身份证', '军官证','护照']
      }
    ],
    onChange: function(p, v, dv) {
      $("#buyer2").val(dv[0]);
      console.log(dv[0]);
    },
    onClose: function(p, v, d) {
    	var buyer2=$("#buyer2").val();
    	$(".buyer2").find(".mustspan").html(buyer2);
    	setlocalStorage("buyer2",buyer2);
        $('.buyer2').find(".mustspan").addClass("color333");
        $(".buyer2").removeClass("errcolor");
        checksfz();
    }
});

$(".page2 #buyer4").picker({
    title: "请选择",
    cols: [
      {
        textAlign: 'center',
         values: ['是', '否']
      }
    ],
    onChange: function(p, v, dv) {
      $("#buyer4").val(dv[0]);
      var marriage=$("body").attr("marriage");
      if(marriage=="未婚单身"){
      	 if(dv[0]=="是"){
	    	$("#buyer4").picker("setValue", ["否"]);
	      }
      }else if(marriage=="离异单身(含带未成年子女)"){
      	 var divorce=$("body").attr("divorce");
      	 if(divorce=="2018年4月4日后"){
      	 	 if(dv[0]=="是"){
		    	$("#buyer4").picker("setValue", ["否"]);
		      }
      	 }
      }
       var hzhouse=$("body").attr("hzhouse");
       if(hzhouse){
	      if(hzhouse!="0套"){
	      	 if(dv[0]=="是"){
		    	$("#buyer4").picker("setValue", ["否"]);
		      }
	      }
       }
      var otherHouse=$("body").attr("otherHouse");
       if(otherHouse){
	      if(otherHouse!="0套"){
	      	 if(dv[0]=="是"){
		    	$("#buyer4").picker("setValue", ["否"]);
		      }
	      }
       }
      
      
      
      
    },
    onClose: function(p, v, d) {
    	var buyer4=$("#buyer4").val();
    	$(".buyer4").find(".mustspan").html(buyer4);
    	setlocalStorage("buyer4",buyer4);
        $('.buyer4').find(".mustspan").addClass("color333");
        $(".buyer4").removeClass("errcolor")
        console.log(buyer4);
        if(buyer4=='是'){
        	$(".cdbh").show();
        }else{
        	$(".cdbh").hide();
        }
    }
});

$(".page2 #buyer6").picker({
    title: "请选择",
    cols: [
      {
        textAlign: 'center',
         values: ['无', '已结清','在贷']
      }
    ],
    onChange: function(p, v, dv) {
      $("#buyer6").val(dv[0]);
      console.log(dv[0]);
    },
    onClose: function(p, v, d) {
    	var buyer2=$("#buyer6").val();
    	$(".buyer6").find(".mustspan").html(buyer2);
        $('.buyer6').find(".mustspan").addClass("color333");
        $(".buyer6").removeClass("errcolor")
        
        var household=$("body").attr("household");
        if(household!="非杭州户籍"){
        	if(buyer2=="已结清"||buyer2=="在贷"){
        		buyer8arr=2;
        		$("#buyer8").val("全款");
	    		$(".buyer8").find(".mustspan").html("全款");
	    		$(".buyer8").find(".mustspan").addClass("color333")
        	}else{
        		var buyer7=$("#buyer7").val();
        		if(buyer7=="一次性付款"){
        			buyer8arr=1;
        			$("#buyer8").val("全款");
		    		$(".buyer8").find(".mustspan").html("全款");
		    		$(".buyer8").find(".mustspan").addClass("color333")
        		}else{
        			buyer8arr=0;
        			$("#buyer8").val("全款");
		    		$(".buyer8").find(".mustspan").html("全款");
		    		$(".buyer8").find(".mustspan").addClass("color333")
        		}
        	}
        }else{
        	var buyer5=$("#buyer5").val();
        	if(buyer5=="2套及以上"){
        		if(buyer2=="在贷"){
        			buyer8arr=1;
        			$("#buyer8").val("全款");
		    		$(".buyer8").find(".mustspan").html("全款");
		    		$(".buyer8").find(".mustspan").addClass("color333")
        		}else{
        			var buyer7=$("#buyer7").val();
	        		if(buyer7=="一次性付款"){
	        			buyer8arr=1;
	        			$("#buyer8").val("全款");
			    		$(".buyer8").find(".mustspan").html("全款");
			    		$(".buyer8").find(".mustspan").addClass("color333")
	        		}else{
	        			buyer8arr=0;
	        			$("#buyer8").val("全款");
			    		$(".buyer8").find(".mustspan").html("全款");
			    		$(".buyer8").find(".mustspan").addClass("color333")
	        		}
        		}
        	}else{
        		var buyer7=$("#buyer7").val();
        		if(buyer7=="一次性付款"){
        			buyer8arr=1;
        		}else{
        			buyer8arr=0;
        		}
        		$("#buyer8").val("全款");
	    		$(".buyer8").find(".mustspan").html("全款");
	    		$(".buyer8").find(".mustspan").addClass("color333")
        	}	
        }   
    }
});

var buyer8arr=0;
$(".page2 #buyer7").picker({
    title: "请选择",
    cols: [
      {
        textAlign: 'center',
         values: ['商业贷款', '公积金贷款','组合贷款','一次性付款']
      }
    ],
    onChange: function(p, v, dv) {
      $("#buyer7").val(dv[0]);
      console.log(dv[0]);
    },
    onClose: function(p, v, d) {
    	var buyer7=$("#buyer7").val();
    	$(".buyer7").find(".mustspan").html(buyer7);
    	if(buyer7=="一次性付款"){
    		buyer8arr=1;
    		$("#buyer8").val("全款");
    		$(".buyer8").find(".mustspan").html("全款");
    		$(".buyer8").find(".mustspan").addClass("color333")
    	}else{
    		var buyer8=$("#buyer8").val();
    		if(buyer8=='全款'){
    			$("#buyer8").val("");
    		    $(".buyer8").find(".mustspan").html("请选择");
    		    $(".buyer8").find(".mustspan").removeClass("color333")
    		}
    		buyer8arr=0;
    	}
        $('.buyer7').find(".mustspan").addClass("color333");
        $(".buyer7").removeClass("errcolor")
    }
});


$(".page2 #buyer8").picker({
    title: "请选择",
    cols: [
      {
        textAlign: 'center',
         values: ['3成', '4成', '4成以上','全款']
      }
    ],
    onChange: function(p, v, dv) {
    	var choseDate = $(".picker-items-col-wrapper").eq(0).find('.picker-selected').attr("data-picker-value");
    	console.log(choseDate);
    	console.log(dv[0]);
    	$("#buyer8").val(dv[0]);
    	
    	if(buyer8arr==1){
    		$("#buyer8").picker("setValue", ["全款"]);
    		$("#buyer8").val(dv[0]);
        }else{
        	if(dv[0]=='全款'){
        		$("#buyer8").picker("setValue", ["4成以上"]);
    		    $("#buyer8").val(dv[0]);
        	}
        }

    },
    onClose: function(p, v, d) {
    	var buyer2=$("#buyer8").val();
    	$(".buyer8").find(".mustspan").html(buyer2);
    	$('.buyer8').find(".mustspan").addClass("color333");
    	if(buyer8arr==1){
    		if(buyer2!="全款"){
    			   $("#buyer8").val("全款");
    		       $(".buyer8").find(".mustspan").html("全款");
    		       $(".buyer8").find(".mustspan").addClass("color333");
    		}
    	}
    	$(".buyer8").removeClass("errcolor")
    }
});	


$(".page2 #buyer9").picker({
    title: "请选择",
    cols: [
      {
        textAlign: 'center',
         values: ['无','陈国仙','陈丽','方城栋','邵捷','卫智超','姚小佳','姚瑛','张宗委']
      }
    ],
    onChange: function(p, v, dv) {
      $("#buyer9").val(dv[0]);
      console.log(dv[0]);
    },
    onClose: function(p, v, d) {
    	var buyer9=$("#buyer9").val();
    	$(".buyer9").find(".mustspan").html(buyer9);
    	setlocalStorage("buyer9",buyer9);
        $('.buyer9').find(".mustspan").addClass("color333");
    }
});

$(".page2 #buyer10").picker({
    title: "请选择",
    cols: [
      {
        textAlign: 'center',
         values: ['30岁及以下', '31-40岁','41-50岁','51-60岁','61岁及以上']
      }
    ],
    onChange: function(p, v, dv) {
      $("#buyer10").val(dv[0]);
      console.log(dv[0]);
    },
    onClose: function(p, v, d) {
    	var buyer10=$("#buyer10").val();
    	$(".buyer10").find(".mustspan").html(buyer10);
    	setlocalStorage("buyer10",buyer10);
        $('.buyer10').find(".mustspan").addClass("color333");
    }
});

$(".page2 #buyer11").picker({
    title: "请选择",
    cols: [
      {
        textAlign: 'center',
         values: ['96方', '100方']
      }
    ],
    onChange: function(p, v, dv) {
      $("#buyer11").val(dv[0]);
      console.log(dv[0]);
    },
    onClose: function(p, v, d) {
    	var buyer11=$("#buyer11").val();
    	$(".buyer11").find(".mustspan").html(buyer11);
    	setlocalStorage("buyer11",buyer11);
        $('.buyer11').find(".mustspan").addClass("color333");
    }
});
$(".page2 #buyer12").picker({
    title: "请选择",
    cols: [
      {
        textAlign: 'center',
        values: ['是', '否']
      }
    ],
    onChange: function(p, v, dv) {
      $("#buyer12").val(dv[0]);
      console.log(dv[0]);
    },
    onClose: function(p, v, d) {
    	var buyer12=$("#buyer12").val();
    	$(".buyer12").find(".mustspan").html(buyer12);
    	setlocalStorage("buyer12",buyer12);
        $('.buyer12').find(".mustspan").addClass("color333");
    }
});
$(".page2 #buyer13").picker({
    title: "请选择",
    cols: [
      {
        textAlign: 'center',
        values: ['是', '否']
      }
    ],
    onChange: function(p, v, dv) {
      $("#buyer13").val(dv[0]);
      console.log(dv[0]);
    },
    onClose: function(p, v, d) {
    	var buyer13=$("#buyer13").val();
    	$(".buyer13").find(".mustspan").html(buyer13);
    	setlocalStorage("buyer13",buyer13);
        $('.buyer13').find(".mustspan").addClass("color333");
        if(buyer13=='是'){
			$(".marriage").hide();
		    $(".addzoomarriageshow").hide();
		    $(".addzoomarriage").show();
		}else{
			$(".marriage").hide();
			$(".addzoomarriage").hide();
			$(".addzoomarriage").hide();
		}
    }
});
})